[2020-04-10 17:11:50,669] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:11:56,916] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:11:56,937] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 18 and epoch zk version is now 18 (kafka.controller.KafkaController)
[2020-04-10 17:11:56,937] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 17:11:56,940] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 17:11:56,943] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 17:11:56,946] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 17:11:56,959] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 890) (kafka.controller.KafkaController)
[2020-04-10 17:11:56,968] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:11:56,978] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:11:56,989] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:11:56,989] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:11:56,989] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 17:11:56,990] INFO [Controller id=0] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 17:11:56,990] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 17:11:56,995] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 17:11:56,995] INFO [Controller id=0] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 17:11:56,995] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 17:11:56,996] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 17:11:56,996] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 17:11:57,008] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:11:57,016] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:11:57,022] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:11:57,052] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:11:57,102] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:11:57,102] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:11:57,105] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:11:57,173] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(BatchTopic-0 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:11:57,174] INFO [Controller id=0] Ready to serve as the new controller with epoch 18 (kafka.controller.KafkaController)
[2020-04-10 17:11:57,181] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:11:57,182] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:11:57,183] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 17:11:57,185] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 17:11:57,191] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 17:11:57,209] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 17:11:58,952] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 17:11:58,954] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:11:58,958] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:11:58,960] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-04-10 17:11:58,962] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:11:58,979] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 17:11:58,986] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 890, 1 -> 909) (kafka.controller.KafkaController)
[2020-04-10 17:11:59,032] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:11:59,043] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:12:01,058] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 17:12:01,058] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:12:01,061] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 17:12:01,062] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:12:01,063] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:12:01,077] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 17:12:01,078] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 890, 1 -> 909, 2 -> 925) (kafka.controller.KafkaController)
[2020-04-10 17:12:01,134] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:01,149] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:12:02,211] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 17:12:02,212] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 17:12:02,213] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 17:12:02,214] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2020-04-10 17:12:02,215] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-04-10 17:12:08,495] DEBUG [Controller id=0] Sending MetadataRequest to Brokers: Vector(0, 1, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 17:12:32,801] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,801] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,802] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,805] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:12:32,829] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:12:32,830] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,1,LeaderEpoch:19,ControllerEpoch:18) (kafka.controller.KafkaController)
[2020-04-10 17:12:32,836] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,836] DEBUG [Controller id=0] All shutting down brokers: 0,2 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,836] DEBUG [Controller id=0] Live brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,851] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:32,853] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:20,ControllerEpoch:18) (kafka.controller.KafkaController)
[2020-04-10 17:12:32,855] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,855] DEBUG [Controller id=0] All shutting down brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 17:12:32,855] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:12:32,865] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:20,ControllerEpoch:18) (kafka.controller.KafkaController)
[2020-04-10 17:12:32,952] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,054] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,155] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,258] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,359] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,461] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,563] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,664] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,766] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,868] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:33,969] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:34,077] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:34,179] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:34,278] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:34,278] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:34,278] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:34,279] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:12:34,279] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(2, 1, 0) (kafka.controller.KafkaController)
[2020-04-10 17:12:34,280] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:34,281] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:34,282] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:34,282] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,282] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,282] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,285] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,285] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,285] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,286] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,287] WARN [RequestSendThread controllerId=0] Controller 0 epoch 18 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=18, brokerEpoch=890, partitionStates=[LeaderAndIsrPartitionState(topicName='BatchTopic', partitionIndex=0, controllerEpoch=18, leader=1, leaderEpoch=20, isr=[1], zkVersion=29, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false)], liveLeaders=(pop-os.localdomain:9093 (id: 1 rack: null))) to broker pop-os.localdomain:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1039)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1328)
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:277)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.backoff$1(ControllerChannelManager.scala:238)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:12:34,287] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,287] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,287] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,290] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:12:34,310] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 19 and epoch zk version is now 19 (kafka.controller.KafkaController)
[2020-04-10 17:12:34,310] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 17:12:34,315] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 17:12:34,317] DEBUG [Controller id=1] Broker 2 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2020-04-10 17:12:34,319] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 17:12:34,324] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 17:12:34,329] INFO [Controller id=2] Initialized broker epochs cache: Map(1 -> 909, 2 -> 925) (kafka.controller.KafkaController)
[2020-04-10 17:12:34,338] DEBUG [Controller id=2] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2020-04-10 17:12:34,346] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:12:34,350] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:12:34,354] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,354] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,354] INFO [Controller id=2] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2020-04-10 17:12:34,354] INFO [Controller id=2] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 17:12:34,355] INFO [Controller id=2] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 17:12:34,355] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 17:12:34,359] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 17:12:34,359] INFO [Controller id=2] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 17:12:34,359] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 17:12:34,359] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 17:12:34,360] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 17:12:34,368] INFO [RequestSendThread controllerId=2] Controller 2 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,368] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:34,368] INFO [RequestSendThread controllerId=2] Controller 2 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:12:34,373] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:34,387] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:34,399] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:34,400] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:34,402] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:34,404] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:34,404] INFO [Controller id=2] Ready to serve as the new controller with epoch 19 (kafka.controller.KafkaController)
[2020-04-10 17:12:34,408] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:12:34,409] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:12:34,409] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 17:12:34,409] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 17:12:34,410] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 17:12:34,422] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 17:12:37,864] INFO [Controller id=2] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 17:12:37,865] DEBUG [Controller id=2] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 17:12:37,866] DEBUG [Controller id=2] Live brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 17:12:37,896] TRACE [Controller id=2] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:20,ControllerEpoch:19) (kafka.controller.KafkaController)
[2020-04-10 17:12:37,902] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 17:12:37,902] DEBUG [Controller id=2] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 17:12:37,903] DEBUG [Controller id=2] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:12:37,906] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:12:37,910] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:12:37,910] TRACE [Controller id=2] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:20,ControllerEpoch:19) (kafka.controller.KafkaController)
[2020-04-10 17:12:39,223] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:39,224] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:39,224] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:39,225] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:12:39,225] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(2, 1) (kafka.controller.KafkaController)
[2020-04-10 17:12:39,228] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:39,229] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:39,230] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,231] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,231] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,238] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,238] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,238] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,242] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:12:39,259] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 20 and epoch zk version is now 20 (kafka.controller.KafkaController)
[2020-04-10 17:12:39,259] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 17:12:39,264] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 17:12:39,271] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 17:12:39,273] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 17:12:39,278] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 909) (kafka.controller.KafkaController)
[2020-04-10 17:12:39,286] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2020-04-10 17:12:39,295] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:12:39,305] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,305] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2020-04-10 17:12:39,305] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 17:12:39,306] INFO [Controller id=1] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 17:12:39,306] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 17:12:39,310] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 17:12:39,310] INFO [Controller id=1] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 17:12:39,310] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 17:12:39,311] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 17:12:39,311] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 17:12:39,323] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:39,324] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:12:39,328] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:39,346] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:39,360] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:39,361] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:39,364] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:39,365] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:39,366] INFO [Controller id=1] Ready to serve as the new controller with epoch 20 (kafka.controller.KafkaController)
[2020-04-10 17:12:39,369] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:12:39,370] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:12:39,370] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 17:12:39,370] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 17:12:39,371] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 17:12:39,379] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 17:12:42,922] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 17:12:42,923] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 17:12:42,924] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:12:42,958] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:20,ControllerEpoch:20) (kafka.controller.KafkaController)
[2020-04-10 17:12:44,382] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 17:12:44,382] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 17:12:44,390] DEBUG [Controller id=1] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 17:12:44,392] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 17:12:44,393] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 17:12:44,394] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 17:12:49,326] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:49,327] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:49,327] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:12:49,327] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:12:49,328] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2020-04-10 17:12:49,329] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:12:49,330] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:12:49,331] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:12:49,331] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:12:49,331] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:12:49,334] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:15:28,513] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:15:34,761] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:34,783] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 21 and epoch zk version is now 21 (kafka.controller.KafkaController)
[2020-04-10 17:15:34,784] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 17:15:34,788] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 17:15:34,794] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 17:15:34,797] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 17:15:34,820] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 956) (kafka.controller.KafkaController)
[2020-04-10 17:15:34,833] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:15:34,849] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:15:34,859] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:15:34,859] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:15:34,860] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 17:15:34,860] INFO [Controller id=0] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 17:15:34,860] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 17:15:34,866] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 17:15:34,867] INFO [Controller id=0] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 17:15:34,867] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 17:15:34,868] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 17:15:34,868] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 17:15:34,884] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:15:34,889] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:15:34,891] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:15:34,949] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:15:34,997] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:15:34,998] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:15:35,000] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:15:35,063] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(BatchTopic-0 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:15:35,063] INFO [Controller id=0] Ready to serve as the new controller with epoch 21 (kafka.controller.KafkaController)
[2020-04-10 17:15:35,068] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:15:35,068] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:15:35,069] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 17:15:35,069] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 17:15:35,071] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 17:15:35,086] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 17:15:36,944] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 17:15:36,944] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:15:36,947] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:15:36,949] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-04-10 17:15:36,958] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:15:36,981] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 17:15:36,983] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 956, 1 -> 975) (kafka.controller.KafkaController)
[2020-04-10 17:15:37,023] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:37,044] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:15:38,960] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 17:15:38,960] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:15:38,963] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:15:38,963] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 17:15:38,965] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:15:38,967] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 17:15:38,972] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 956, 1 -> 975, 2 -> 993) (kafka.controller.KafkaController)
[2020-04-10 17:15:39,030] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:39,042] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:15:40,088] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 17:15:40,088] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 17:15:40,092] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 17:15:40,093] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 17:15:40,094] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 17:15:40,095] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions BatchTopic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 17:15:40,099] ERROR [Controller id=0] Error completing replica leader election (PREFERRED) for partition BatchTopic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition BatchTopic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.Map$Map1.foreach(Map.scala:128)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:40,100] WARN [Controller id=0] Partition BatchTopic-0 failed to complete preferred replica leader election to 2. Leader is still 1 (kafka.controller.KafkaController)
[2020-04-10 17:15:46,860] DEBUG [Controller id=0] Sending MetadataRequest to Brokers: Vector(0, 1, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 17:15:56,985] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 17:15:56,985] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 17:15:56,985] DEBUG [Controller id=0] Live brokers: 0,2 (kafka.controller.KafkaController)
[2020-04-10 17:15:57,008] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:2,ISR:0,2,LeaderEpoch:23,ControllerEpoch:21) (kafka.controller.KafkaController)
[2020-04-10 17:15:57,015] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 17:15:57,016] DEBUG [Controller id=0] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 17:15:57,017] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:15:57,038] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:21) (kafka.controller.KafkaController)
[2020-04-10 17:15:57,046] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 17:15:57,046] DEBUG [Controller id=0] All shutting down brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 17:15:57,047] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:15:57,054] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:21) (kafka.controller.KafkaController)
[2020-04-10 17:15:57,078] WARN [RequestSendThread controllerId=0] Controller 0 epoch 21 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=21, brokerEpoch=993, partitionStates=[UpdateMetadataPartitionState(topicName='BatchTopic', partitionIndex=0, controllerEpoch=21, leader=2, leaderEpoch=23, isr=[0, 2], zkVersion=34, replicas=[2, 1, 0], offlineReplicas=[1])], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=2, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9094, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker pop-os.localdomain:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:257)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,181] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,284] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,385] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,488] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,590] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,691] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,794] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,896] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:57,998] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:58,099] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:58,114] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:58,115] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:58,115] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:58,115] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:15:58,116] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 17:15:58,117] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:15:58,117] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:15:58,119] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:15:58,127] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2020-04-10 17:15:58,128] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:15:58,128] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:15:58,128] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:15:58,130] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2020-04-10 17:15:58,131] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-04-10 17:15:58,144] DEBUG [Controller id=0] Unregister BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 17:15:58,145] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 956, 2 -> 993) (kafka.controller.KafkaController)
[2020-04-10 17:15:58,200] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:58,302] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:15:58,350] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:58,350] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:58,350] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:15:58,351] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:15:58,351] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 17:15:58,352] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:15:58,353] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:15:58,354] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:15:58,361] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:15:58,361] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:15:58,362] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-04-10 17:15:58,362] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:15:58,362] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:15:58,365] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2020-04-10 17:15:58,365] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-04-10 17:15:58,375] DEBUG [Controller id=0] Unregister BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 17:15:58,376] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 956) (kafka.controller.KafkaController)
[2020-04-10 17:16:02,068] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 17:16:02,068] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:16:02,068] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:16:02,074] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:21) (kafka.controller.KafkaController)
[2020-04-10 17:16:07,083] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 17:16:07,084] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:16:07,084] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:16:07,091] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:21) (kafka.controller.KafkaController)
[2020-04-10 17:16:13,078] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:16:13,079] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:16:13,079] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:16:13,079] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:16:13,079] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:16:13,080] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:16:13,081] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:16:13,082] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:16:13,082] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:16:13,082] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:16:13,084] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:19:19,542] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:20:09,502] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:20:42,800] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:20:52,606] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:21:19,276] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:21:24,337] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:21:24,649] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:24:06,333] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:24:33,652] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:27:47,961] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:27:54,580] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:27:54,600] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 22 and epoch zk version is now 22 (kafka.controller.KafkaController)
[2020-04-10 17:27:54,601] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 17:27:54,605] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 17:27:54,608] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 17:27:54,611] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 17:27:54,627] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 1017) (kafka.controller.KafkaController)
[2020-04-10 17:27:54,640] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:27:54,651] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:27:54,660] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:27:54,661] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:27:54,661] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 17:27:54,662] INFO [Controller id=0] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 17:27:54,662] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 17:27:54,667] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 17:27:54,667] INFO [Controller id=0] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 17:27:54,667] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 17:27:54,668] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 17:27:54,668] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 17:27:54,676] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:27:54,681] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:27:54,683] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:27:54,717] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:27:54,737] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:27:54,737] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:27:54,740] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:27:54,756] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:27:54,756] INFO [Controller id=0] Ready to serve as the new controller with epoch 22 (kafka.controller.KafkaController)
[2020-04-10 17:27:54,766] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:27:54,766] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:27:54,767] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 17:27:54,767] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 17:27:54,768] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 17:27:54,799] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 17:27:56,395] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 17:27:56,395] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:27:56,398] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:27:56,399] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-04-10 17:27:56,401] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:27:56,408] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 17:27:56,409] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 1017, 1 -> 1035) (kafka.controller.KafkaController)
[2020-04-10 17:27:56,449] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:27:56,462] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:27:58,482] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 17:27:58,482] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:27:58,485] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 17:27:58,485] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:27:58,487] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:27:58,488] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 17:27:58,490] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 1017, 1 -> 1035, 2 -> 1052) (kafka.controller.KafkaController)
[2020-04-10 17:27:58,529] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:27:58,540] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:27:59,801] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 17:27:59,801] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 17:27:59,805] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 17:27:59,808] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 17:27:59,811] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 17:27:59,812] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions BatchTopic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 17:27:59,832] ERROR [Controller id=0] Error completing replica leader election (PREFERRED) for partition BatchTopic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition BatchTopic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.Map$Map1.foreach(Map.scala:128)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:27:59,832] WARN [Controller id=0] Partition BatchTopic-0 failed to complete preferred replica leader election to 2. Leader is still 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:06,968] DEBUG [Controller id=0] Sending MetadataRequest to Brokers: Vector(0, 1, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 17:28:29,522] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:28:39,890] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,891] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,891] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,900] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:28:39,919] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:28:39,920] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,1,LeaderEpoch:25,ControllerEpoch:22) (kafka.controller.KafkaController)
[2020-04-10 17:28:39,924] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,924] DEBUG [Controller id=0] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,924] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,925] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:28:39,934] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 17:28:39,934] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:22) (kafka.controller.KafkaController)
[2020-04-10 17:28:39,935] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,935] DEBUG [Controller id=0] All shutting down brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 17:28:39,935] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:28:39,942] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:22) (kafka.controller.KafkaController)
[2020-04-10 17:28:39,947] WARN [RequestSendThread controllerId=0] Controller 0 epoch 22 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=22, brokerEpoch=1052, partitionStates=[LeaderAndIsrPartitionState(topicName='BatchTopic', partitionIndex=0, controllerEpoch=22, leader=0, leaderEpoch=26, isr=[0], zkVersion=39, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false)], liveLeaders=(pop-os.localdomain:9092 (id: 0 rack: null))) to broker pop-os.localdomain:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:257)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:39,956] WARN [RequestSendThread controllerId=0] Controller 0 epoch 22 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=22, brokerEpoch=1035, partitionStates=[UpdateMetadataPartitionState(topicName='BatchTopic', partitionIndex=0, controllerEpoch=22, leader=0, leaderEpoch=26, isr=[0], zkVersion=39, replicas=[2, 1, 0], offlineReplicas=[2, 1])], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=2, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9094, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker pop-os.localdomain:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:257)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,050] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,057] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,152] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,159] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,254] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,260] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,355] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,362] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,457] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,463] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,558] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,565] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,660] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,667] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,762] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,768] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,864] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,870] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,965] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,972] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:40,996] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:40,997] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:40,997] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:40,998] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:28:40,999] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 17:28:41,000] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:28:41,001] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:28:41,003] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:28:41,012] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2020-04-10 17:28:41,016] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,016] WARN [RequestSendThread controllerId=0] Controller 0 epoch 22 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=22, brokerEpoch=1035, partitionStates=[UpdateMetadataPartitionState(topicName='BatchTopic', partitionIndex=0, controllerEpoch=22, leader=0, leaderEpoch=26, isr=[0], zkVersion=39, replicas=[2, 1, 0], offlineReplicas=[2, 1])], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=2, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9094, host='pop-os.localdomain', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker pop-os.localdomain:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1039)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1328)
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:277)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.backoff$1(ControllerChannelManager.scala:238)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:28:41,016] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,017] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,017] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,019] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2020-04-10 17:28:41,021] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-04-10 17:28:41,028] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:41,029] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:41,029] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:41,029] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:28:41,029] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 17:28:41,030] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:28:41,031] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:28:41,034] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:28:41,040] DEBUG [Controller id=0] Unregister BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 17:28:41,041] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 1017, 2 -> 1052) (kafka.controller.KafkaController)
[2020-04-10 17:28:41,044] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:41,044] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,044] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,044] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,044] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:28:41,046] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2020-04-10 17:28:41,046] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-04-10 17:28:41,052] DEBUG [Controller id=0] Unregister BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 17:28:41,052] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 1017) (kafka.controller.KafkaController)
[2020-04-10 17:28:44,949] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:44,949] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:44,950] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:28:44,953] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:22) (kafka.controller.KafkaController)
[2020-04-10 17:28:49,962] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:49,962] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 17:28:49,962] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 17:28:49,967] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:22) (kafka.controller.KafkaController)
[2020-04-10 17:28:56,111] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:56,111] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:56,111] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:28:56,112] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-04-10 17:28:56,112] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:28:56,112] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:28:56,113] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:28:56,114] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 17:28:56,114] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 17:28:56,114] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 17:28:56,115] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-04-10 17:50:36,080] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 17:50:42,763] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:50:42,783] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 23 and epoch zk version is now 23 (kafka.controller.KafkaController)
[2020-04-10 17:50:42,783] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 17:50:42,787] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 17:50:42,791] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 17:50:42,794] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 17:50:42,810] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 1121) (kafka.controller.KafkaController)
[2020-04-10 17:50:42,824] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:50:42,839] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:50:42,859] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:50:42,860] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-10 17:50:42,860] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 17:50:42,861] INFO [Controller id=0] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 17:50:42,861] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 17:50:42,870] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 17:50:42,871] INFO [Controller id=0] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 17:50:42,871] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 17:50:42,872] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 17:50:42,872] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 17:50:42,887] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:50:42,892] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:50:42,898] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:50:42,932] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:50:42,951] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 17:50:42,952] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:50:42,954] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:50:42,958] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 17:50:42,958] INFO [Controller id=0] Ready to serve as the new controller with epoch 23 (kafka.controller.KafkaController)
[2020-04-10 17:50:42,964] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:50:42,964] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 17:50:42,965] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 17:50:42,965] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 17:50:42,966] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 17:50:43,010] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 17:50:44,661] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 17:50:44,661] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:50:44,664] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:50:44,666] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-04-10 17:50:44,667] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:50:44,677] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 17:50:44,678] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 1121, 1 -> 1139) (kafka.controller.KafkaController)
[2020-04-10 17:50:44,716] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:50:44,727] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:50:46,593] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 17:50:46,593] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 17:50:46,596] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 17:50:46,596] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 17:50:46,600] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 17:50:46,601] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 17:50:46,604] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 1121, 1 -> 1139, 2 -> 1156) (kafka.controller.KafkaController)
[2020-04-10 17:50:46,674] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 17:50:46,689] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 17:50:48,013] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 17:50:48,016] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 17:50:48,022] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 17:50:48,025] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 17:50:48,028] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 17:50:48,029] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions BatchTopic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 17:50:48,056] ERROR [Controller id=0] Error completing replica leader election (PREFERRED) for partition BatchTopic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition BatchTopic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.Map$Map1.foreach(Map.scala:128)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 17:50:48,057] WARN [Controller id=0] Partition BatchTopic-0 failed to complete preferred replica leader election to 2. Leader is still 0 (kafka.controller.KafkaController)
[2020-04-10 17:50:55,149] DEBUG [Controller id=0] Sending MetadataRequest to Brokers: Vector(0, 1, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 17:51:07,703] INFO [Controller id=0] New topics: [Set(ReportTopic)], deleted topics: [Set()], new partition replica assignment [Map(ReportTopic-0 -> ReplicaAssignment(replicas=0,2,1, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-04-10 17:51:07,703] INFO [Controller id=0] New partition creation callback for ReportTopic-0 (kafka.controller.KafkaController)
[2020-04-10 17:51:11,934] INFO [Controller id=0] New topics: [Set(AlarmTopic)], deleted topics: [Set()], new partition replica assignment [Map(AlarmTopic-0 -> ReplicaAssignment(replicas=1,0,2, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-04-10 17:51:11,935] INFO [Controller id=0] New partition creation callback for AlarmTopic-0 (kafka.controller.KafkaController)
[2020-04-10 17:52:47,580] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [Set()], new partition replica assignment [Map(__consumer_offsets-22 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-04-10 17:52:47,581] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-37,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-38,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-13,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2020-04-10 17:55:48,057] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 17:55:48,058] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 17:55:48,063] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(__consumer_offsets-8 -> Vector(2), __consumer_offsets-35 -> Vector(2), __consumer_offsets-41 -> Vector(2), __consumer_offsets-23 -> Vector(2), __consumer_offsets-47 -> Vector(2), __consumer_offsets-38 -> Vector(2), __consumer_offsets-17 -> Vector(2), __consumer_offsets-11 -> Vector(2), __consumer_offsets-2 -> Vector(2), __consumer_offsets-14 -> Vector(2), BatchTopic-0 -> Vector(2, 1, 0), __consumer_offsets-20 -> Vector(2), __consumer_offsets-44 -> Vector(2), __consumer_offsets-5 -> Vector(2), __consumer_offsets-26 -> Vector(2), __consumer_offsets-29 -> Vector(2), __consumer_offsets-32 -> Vector(2)), 1 -> Map(__consumer_offsets-22 -> Vector(1), AlarmTopic-0 -> Vector(1, 0, 2), __consumer_offsets-4 -> Vector(1), __consumer_offsets-7 -> Vector(1), __consumer_offsets-46 -> Vector(1), __consumer_offsets-25 -> Vector(1), __consumer_offsets-49 -> Vector(1), __consumer_offsets-16 -> Vector(1), __consumer_offsets-28 -> Vector(1), __consumer_offsets-31 -> Vector(1), __consumer_offsets-37 -> Vector(1), __consumer_offsets-19 -> Vector(1), __consumer_offsets-13 -> Vector(1), __consumer_offsets-43 -> Vector(1), __consumer_offsets-1 -> Vector(1), __consumer_offsets-34 -> Vector(1), __consumer_offsets-10 -> Vector(1), __consumer_offsets-40 -> Vector(1)), 0 -> Map(__consumer_offsets-30 -> Vector(0), __consumer_offsets-21 -> Vector(0), __consumer_offsets-27 -> Vector(0), __consumer_offsets-9 -> Vector(0), __consumer_offsets-33 -> Vector(0), __consumer_offsets-36 -> Vector(0), __consumer_offsets-42 -> Vector(0), __consumer_offsets-3 -> Vector(0), __consumer_offsets-18 -> Vector(0), __consumer_offsets-15 -> Vector(0), __consumer_offsets-24 -> Vector(0), ReportTopic-0 -> Vector(0, 2, 1), __consumer_offsets-48 -> Vector(0), __consumer_offsets-6 -> Vector(0), __consumer_offsets-0 -> Vector(0), __consumer_offsets-39 -> Vector(0), __consumer_offsets-12 -> Vector(0), __consumer_offsets-45 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-10 17:55:48,063] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 17:55:48,063] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.058823529411764705 (kafka.controller.KafkaController)
[2020-04-10 17:55:48,063] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2020-04-10 17:55:48,063] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-04-10 17:55:48,063] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-10 17:55:48,063] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
