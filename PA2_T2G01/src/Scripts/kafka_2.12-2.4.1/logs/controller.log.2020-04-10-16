[2020-04-10 16:33:03,082] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:33:20,998] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:33:32,420] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:33:32,439] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 8 and epoch zk version is now 8 (kafka.controller.KafkaController)
[2020-04-10 16:33:32,439] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:33:32,442] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:33:32,445] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:33:32,451] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:33:32,472] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 514) (kafka.controller.KafkaController)
[2020-04-10 16:33:32,476] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2020-04-10 16:33:32,483] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:33:32,505] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:33:32,506] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2020-04-10 16:33:32,506] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:33:32,507] INFO [Controller id=1] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:33:32,507] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:33:32,512] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:33:32,512] INFO [Controller id=1] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:33:32,513] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:33:32,513] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-04-10 16:33:32,514] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:33:32,527] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:33:32,528] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:33:32,538] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:33:32,538] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:33:32,539] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map() (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:33:32,539] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:33:32,540] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:33:32,546] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map() (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:33:32,547] INFO [Controller id=1] Ready to serve as the new controller with epoch 8 (kafka.controller.KafkaController)
[2020-04-10 16:33:32,553] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:33:32,553] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:33:32,554] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:33:32,555] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:33:32,556] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:33:32,573] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:33:37,135] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 16:33:37,136] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:33:37,139] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:33:37,141] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 16:33:37,144] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:33:37,151] DEBUG [Controller id=1] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 16:33:37,155] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 514, 2 -> 532) (kafka.controller.KafkaController)
[2020-04-10 16:33:37,198] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:33:37,212] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:33:37,575] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:33:37,575] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:33:37,577] DEBUG [Controller id=1] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-04-10 16:35:37,223] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:35:37,223] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:35:37,223] DEBUG [Controller id=1] Live brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:35:37,226] TRACE [Controller id=1] All leaders =  (kafka.controller.KafkaController)
[2020-04-10 16:35:37,233] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:35:37,233] DEBUG [Controller id=1] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 16:35:37,233] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:35:37,234] TRACE [Controller id=1] All leaders =  (kafka.controller.KafkaController)
[2020-04-10 16:35:38,407] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:35:38,408] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:35:38,408] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:35:38,408] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:35:38,409] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(2, 1) (kafka.controller.KafkaController)
[2020-04-10 16:35:38,410] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:35:38,413] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:35:38,415] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:35:38,415] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:35:38,415] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:35:38,417] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:35:38,417] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:35:38,417] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:35:38,418] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:35:38,578] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:35:38,579] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:35:38,579] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:35:38,579] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:35:38,580] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 16:35:38,581] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:35:38,582] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:35:38,583] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:35:53,808] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:36:00,602] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:36:00,621] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 9 and epoch zk version is now 9 (kafka.controller.KafkaController)
[2020-04-10 16:36:00,621] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:36:00,624] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:36:00,632] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:36:00,634] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:36:00,655] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 550) (kafka.controller.KafkaController)
[2020-04-10 16:36:00,660] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2020-04-10 16:36:00,665] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:36:00,684] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:36:00,685] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2020-04-10 16:36:00,685] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:36:00,686] INFO [Controller id=1] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:36:00,686] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:36:00,690] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:36:00,690] INFO [Controller id=1] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:36:00,691] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:36:00,692] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-04-10 16:36:00,692] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:36:00,705] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:36:00,706] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:36:00,717] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:36:00,718] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:36:00,718] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map() (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:36:00,718] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:36:00,720] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:36:00,725] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map() (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:36:00,726] INFO [Controller id=1] Ready to serve as the new controller with epoch 9 (kafka.controller.KafkaController)
[2020-04-10 16:36:00,731] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:36:00,731] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:36:00,732] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:36:00,732] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:36:00,733] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:36:00,746] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:36:05,089] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 16:36:05,090] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:36:05,092] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:36:05,095] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 16:36:05,097] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:36:05,099] DEBUG [Controller id=1] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 16:36:05,101] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 550, 2 -> 568) (kafka.controller.KafkaController)
[2020-04-10 16:36:05,153] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:36:05,165] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:36:05,748] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:36:05,749] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:36:05,753] DEBUG [Controller id=1] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-04-10 16:38:40,741] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:38:44,351] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:38:44,352] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:38:44,352] DEBUG [Controller id=1] Live brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:38:44,355] TRACE [Controller id=1] All leaders =  (kafka.controller.KafkaController)
[2020-04-10 16:38:44,360] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:38:44,361] DEBUG [Controller id=1] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 16:38:44,361] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:38:44,364] TRACE [Controller id=1] All leaders =  (kafka.controller.KafkaController)
[2020-04-10 16:38:45,446] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:38:45,447] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:38:45,447] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:38:45,447] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:38:45,448] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(2, 1) (kafka.controller.KafkaController)
[2020-04-10 16:38:45,449] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:38:45,450] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:38:45,450] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:38:45,451] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:38:45,451] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:38:45,453] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:38:45,453] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:38:45,453] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:38:45,454] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:38:45,755] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:38:45,756] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:38:45,756] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:38:45,756] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:38:45,767] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 16:38:45,768] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:38:45,769] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:38:45,770] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:38:56,339] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:39:02,740] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:39:02,758] DEBUG [Controller id=0] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:39:02,995] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 10 and epoch zk version is now 10 (kafka.controller.KafkaController)
[2020-04-10 16:39:02,995] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:39:02,999] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:39:03,003] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:39:03,007] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:39:03,016] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 584) (kafka.controller.KafkaController)
[2020-04-10 16:39:03,019] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 16:39:03,025] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:39:03,032] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:39:03,032] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-10 16:39:03,032] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:39:03,033] INFO [Controller id=0] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:39:03,033] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:39:03,035] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:39:03,036] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:39:03,036] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:39:03,036] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-04-10 16:39:03,037] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:39:03,044] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:39:03,044] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:39:03,048] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:39:03,049] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map() (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:39:03,049] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:39:03,050] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:39:03,051] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:39:03,053] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map() (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:39:03,053] INFO [Controller id=0] Ready to serve as the new controller with epoch 10 (kafka.controller.KafkaController)
[2020-04-10 16:39:03,058] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:39:03,058] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:39:03,058] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:39:03,058] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:39:03,059] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:39:03,071] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:39:04,848] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 16:39:04,848] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:39:04,852] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:39:04,853] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-04-10 16:39:04,856] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:39:04,858] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 16:39:04,861] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 584, 1 -> 604) (kafka.controller.KafkaController)
[2020-04-10 16:39:04,914] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:39:04,928] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:39:06,763] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:39:06,763] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:39:06,767] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 16:39:06,767] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:39:06,769] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:39:06,770] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 16:39:06,772] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 584, 1 -> 604, 2 -> 620) (kafka.controller.KafkaController)
[2020-04-10 16:39:06,821] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:39:06,833] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:39:08,072] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:39:08,073] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:39:08,077] DEBUG [Controller id=0] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2020-04-10 16:39:15,095] INFO [Controller id=0] New topics: [Set(BatchTopic)], deleted topics: [Set()], new partition replica assignment [Map(BatchTopic-0 -> ReplicaAssignment(replicas=2,1,0, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-04-10 16:39:15,095] INFO [Controller id=0] New partition creation callback for BatchTopic-0 (kafka.controller.KafkaController)
[2020-04-10 16:42:02,702] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 16:42:02,702] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 16:42:02,703] DEBUG [Controller id=0] Live brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 16:42:02,711] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:38,123] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:42:39,080] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:39,082] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,1,LeaderEpoch:1,ControllerEpoch:10) (kafka.controller.KafkaController)
[2020-04-10 16:42:39,091] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,091] DEBUG [Controller id=0] All shutting down brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,091] DEBUG [Controller id=0] Live brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,092] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:39,102] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:39,102] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:10) (kafka.controller.KafkaController)
[2020-04-10 16:42:39,105] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,105] DEBUG [Controller id=0] All shutting down brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,106] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:42:39,130] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:10) (kafka.controller.KafkaController)
[2020-04-10 16:42:39,132] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,133] DEBUG [Controller id=0] All shutting down brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,133] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:42:39,144] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:10) (kafka.controller.KafkaController)
[2020-04-10 16:42:39,145] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,145] DEBUG [Controller id=0] All shutting down brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:42:39,145] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:42:39,146] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:39,149] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:39,149] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:10) (kafka.controller.KafkaController)
[2020-04-10 16:42:40,476] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:40,476] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:40,476] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:40,477] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:42:40,477] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(2, 1, 0) (kafka.controller.KafkaController)
[2020-04-10 16:42:40,478] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:40,479] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:40,480] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,480] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,480] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,482] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,482] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,482] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,483] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,484] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,484] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,487] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:42:40,516] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 11 and epoch zk version is now 11 (kafka.controller.KafkaController)
[2020-04-10 16:42:40,517] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:42:40,520] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:42:40,524] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:42:40,524] DEBUG [Controller id=2] Broker 1 was elected as controller instead of broker 2 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2020-04-10 16:42:40,527] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:42:40,533] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 604, 2 -> 620) (kafka.controller.KafkaController)
[2020-04-10 16:42:40,542] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2020-04-10 16:42:40,552] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:42:40,558] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:42:40,562] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,562] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,563] INFO [Controller id=1] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2020-04-10 16:42:40,563] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:42:40,563] INFO [Controller id=1] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 16:42:40,563] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:42:40,568] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:42:40,568] INFO [Controller id=1] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 16:42:40,568] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:42:40,568] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 16:42:40,569] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:42:40,577] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:40,577] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,577] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:42:40,582] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:40,595] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:40,609] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:40,610] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:40,614] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:40,616] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:40,616] INFO [Controller id=1] Ready to serve as the new controller with epoch 11 (kafka.controller.KafkaController)
[2020-04-10 16:42:40,622] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:42:40,623] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:42:40,623] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:42:40,623] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:42:40,624] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:42:40,635] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:42:44,063] INFO [Controller id=1] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:42:44,065] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:42:44,070] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:42:44,074] INFO [Controller id=1] New broker startup callback for 0 (kafka.controller.KafkaController)
[2020-04-10 16:42:44,077] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:42:44,087] DEBUG [Controller id=1] Register BrokerModifications handler for Vector(0) (kafka.controller.KafkaController)
[2020-04-10 16:42:44,089] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 604, 2 -> 620, 0 -> 648) (kafka.controller.KafkaController)
[2020-04-10 16:42:44,136] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:44,154] DEBUG [Controller id=0] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:42:44,159] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:42:44,159] DEBUG [Controller id=1] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:42:44,160] DEBUG [Controller id=1] Live brokers: 1,0 (kafka.controller.KafkaController)
[2020-04-10 16:42:44,187] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:11) (kafka.controller.KafkaController)
[2020-04-10 16:42:45,197] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:42:45,197] DEBUG [Controller id=1] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 16:42:45,197] DEBUG [Controller id=1] Live brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 16:42:45,198] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:45,203] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:42:45,203] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:2,ControllerEpoch:11) (kafka.controller.KafkaController)
[2020-04-10 16:42:45,637] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:42:45,637] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:42:45,638] DEBUG [Controller id=1] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 16:42:45,639] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2020-04-10 16:42:45,640] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-04-10 16:42:46,522] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:46,523] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:46,523] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:46,524] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:42:46,524] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(2, 1, 0) (kafka.controller.KafkaController)
[2020-04-10 16:42:46,526] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:46,527] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:46,528] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,528] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,528] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,530] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,530] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,530] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,532] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,532] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,532] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,534] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:42:46,545] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 12 and epoch zk version is now 12 (kafka.controller.KafkaController)
[2020-04-10 16:42:46,545] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:42:46,550] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:42:46,558] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:42:46,561] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:42:46,563] DEBUG [Controller id=0] Broker 2 was elected as controller instead of broker 0 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2020-04-10 16:42:46,566] INFO [Controller id=2] Initialized broker epochs cache: Map(0 -> 648, 2 -> 620) (kafka.controller.KafkaController)
[2020-04-10 16:42:46,574] DEBUG [Controller id=2] Register BrokerModifications handler for Set(0, 2) (kafka.controller.KafkaController)
[2020-04-10 16:42:46,584] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:42:46,590] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:42:46,594] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,594] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,594] INFO [Controller id=2] Currently active brokers in the cluster: Set(0, 2) (kafka.controller.KafkaController)
[2020-04-10 16:42:46,595] INFO [Controller id=2] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:42:46,595] INFO [Controller id=2] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 16:42:46,595] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:42:46,599] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:42:46,599] INFO [Controller id=2] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 16:42:46,600] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:42:46,600] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 16:42:46,601] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:42:46,610] INFO [RequestSendThread controllerId=2] Controller 2 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,610] INFO [RequestSendThread controllerId=2] Controller 2 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:42:46,610] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:46,615] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:46,630] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:46,645] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:46,645] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:46,648] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:46,651] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:46,651] INFO [Controller id=2] Ready to serve as the new controller with epoch 12 (kafka.controller.KafkaController)
[2020-04-10 16:42:46,655] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:42:46,655] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:42:46,655] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:42:46,655] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:42:46,656] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:42:46,667] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:42:46,689] DEBUG [Controller id=2] Sending MetadataRequest to Brokers: Vector(0, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 16:42:50,261] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:50,261] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:50,261] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:42:50,262] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:42:50,263] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(2, 0) (kafka.controller.KafkaController)
[2020-04-10 16:42:50,265] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:50,266] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:50,266] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,267] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,267] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,268] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,269] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,269] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,271] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:42:50,286] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 13 and epoch zk version is now 13 (kafka.controller.KafkaController)
[2020-04-10 16:42:50,286] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:42:50,289] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:42:50,292] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:42:50,293] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:42:50,297] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 648) (kafka.controller.KafkaController)
[2020-04-10 16:42:50,304] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 16:42:50,315] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:42:50,322] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,322] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-10 16:42:50,322] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:42:50,323] INFO [Controller id=0] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 16:42:50,323] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:42:50,327] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:42:50,327] INFO [Controller id=0] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 16:42:50,327] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:42:50,328] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 16:42:50,328] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:42:50,337] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:42:50,337] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:50,341] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:50,355] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:50,375] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:42:50,375] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:50,378] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:50,399] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:42:50,399] INFO [Controller id=0] Ready to serve as the new controller with epoch 13 (kafka.controller.KafkaController)
[2020-04-10 16:42:50,403] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:42:50,404] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:42:50,404] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:42:50,405] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:42:50,406] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:42:50,415] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:42:55,417] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:42:55,418] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:42:55,422] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 16:42:55,425] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 16:42:55,428] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 16:42:55,429] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 16:42:56,983] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 16:42:56,983] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 16:42:56,984] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:42:56,992] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:13) (kafka.controller.KafkaController)
[2020-04-10 16:43:18,980] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:43:19,269] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 16:43:19,269] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 16:43:19,270] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:43:19,277] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:13) (kafka.controller.KafkaController)
[2020-04-10 16:43:24,283] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 16:43:24,283] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 16:43:24,283] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:43:24,286] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:13) (kafka.controller.KafkaController)
[2020-04-10 16:43:27,399] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 16:43:27,400] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:43:27,403] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:43:27,405] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-04-10 16:43:27,408] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:43:27,411] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 16:43:27,415] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 648, 1 -> 721) (kafka.controller.KafkaController)
[2020-04-10 16:43:27,458] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:43:27,469] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:43:29,393] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:43:29,393] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:43:29,396] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 16:43:29,396] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:43:29,399] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:29,399] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:43:29,400] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 16:43:29,402] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 648, 1 -> 721, 2 -> 738) (kafka.controller.KafkaController)
[2020-04-10 16:43:29,450] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:43:29,461] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:43:29,499] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:29,600] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:29,701] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:29,802] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:29,904] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:30,007] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:30,109] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:30,211] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:30,313] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:30,414] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:43:30,425] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:43:30,426] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:43:30,426] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:43:30,426] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:43:30,427] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(2, 1, 0) (kafka.controller.KafkaController)
[2020-04-10 16:43:30,428] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:43:30,430] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:43:30,430] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,431] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,431] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,432] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,432] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,432] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,434] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,434] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,434] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,434] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,439] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:43:30,455] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 14 and epoch zk version is now 14 (kafka.controller.KafkaController)
[2020-04-10 16:43:30,456] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:43:30,459] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:43:30,462] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:43:30,464] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:43:30,462] DEBUG [Controller id=2] Broker 1 was elected as controller instead of broker 2 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2020-04-10 16:43:30,470] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 721, 2 -> 738) (kafka.controller.KafkaController)
[2020-04-10 16:43:30,477] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1, 2) (kafka.controller.KafkaController)
[2020-04-10 16:43:30,486] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:43:30,492] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:43:30,496] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,496] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,496] INFO [Controller id=1] Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2020-04-10 16:43:30,497] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:43:30,497] INFO [Controller id=1] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 16:43:30,497] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:43:30,502] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:43:30,502] INFO [Controller id=1] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 16:43:30,502] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:43:30,503] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 16:43:30,503] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:43:30,512] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:43:30,514] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,514] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:43:30,516] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:43:30,531] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:43:30,568] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:43:30,569] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:43:30,575] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:43:30,598] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:43:30,599] INFO [Controller id=1] Ready to serve as the new controller with epoch 14 (kafka.controller.KafkaController)
[2020-04-10 16:43:30,603] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:43:30,603] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:43:30,603] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:43:30,603] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:43:30,605] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:43:30,615] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:43:35,616] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:43:35,617] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:43:35,621] DEBUG [Controller id=1] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 16:43:35,622] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 16:43:35,623] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 16:43:35,623] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions BatchTopic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 16:43:35,642] INFO [Controller id=1] Partition BatchTopic-0 completed preferred replica leader election. New leader is 2 (kafka.controller.KafkaController)
[2020-04-10 16:43:37,356] DEBUG [Controller id=1] Sending MetadataRequest to Brokers: Vector(1, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 16:44:31,161] INFO [Controller id=1] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:44:31,161] DEBUG [Controller id=1] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:44:31,161] DEBUG [Controller id=1] Live brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:44:31,186] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:8,ControllerEpoch:14) (kafka.controller.KafkaController)
[2020-04-10 16:44:31,189] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:44:31,189] DEBUG [Controller id=1] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2020-04-10 16:44:31,189] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:44:31,195] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:8,ControllerEpoch:14) (kafka.controller.KafkaController)
[2020-04-10 16:44:32,570] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:44:32,570] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:44:32,570] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:44:32,571] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:44:32,571] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 16:44:32,572] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:44:32,573] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:44:32,574] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:44:32,589] INFO [Controller id=1] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:44:32,593] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:44:32,593] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:44:32,593] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:44:32,601] INFO [Controller id=1] Broker failure callback for 2 (kafka.controller.KafkaController)
[2020-04-10 16:44:32,603] INFO [Controller id=1] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-04-10 16:44:32,621] DEBUG [Controller id=1] Unregister BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 16:44:32,622] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 721) (kafka.controller.KafkaController)
[2020-04-10 16:44:36,209] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:44:36,209] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:44:36,209] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:44:36,215] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:8,ControllerEpoch:14) (kafka.controller.KafkaController)
[2020-04-10 16:44:52,093] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:44:52,591] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:44:52,592] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:44:52,592] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:44:52,596] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:8,ControllerEpoch:14) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,396] INFO [Controller id=1] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 16:44:58,397] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:44:58,400] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,401] INFO [Controller id=1] New broker startup callback for 0 (kafka.controller.KafkaController)
[2020-04-10 16:44:58,403] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,403] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:44:58,412] DEBUG [Controller id=1] Register BrokerModifications handler for Vector(0) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,416] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 721, 0 -> 766) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,457] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:44:58,468] DEBUG [Controller id=0] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:44:58,504] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:44:58,605] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:44:58,706] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:44:58,807] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker pop-os.localdomain:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:44:58,820] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:44:58,821] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:44:58,821] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:44:58,822] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:44:58,822] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(1, 0) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,825] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:44:58,827] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:44:58,827] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,828] TRACE [RequestSendThread controllerId=1] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,828] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,828] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,830] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,844] WARN [RequestSendThread controllerId=1] Controller 1 epoch 14 fails to send request (type=LeaderAndIsRequest, controllerId=1, controllerEpoch=14, brokerEpoch=766, partitionStates=[LeaderAndIsrPartitionState(topicName='BatchTopic', partitionIndex=0, controllerEpoch=14, leader=1, leaderEpoch=8, isr=[1], zkVersion=11, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false)], liveLeaders=(pop-os.localdomain:9093 (id: 1 rack: null))) to broker pop-os.localdomain:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Client was shutdown before response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:109)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:257)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:44:58,845] ERROR [RequestSendThread controllerId=1] Controller 1 fails to send a request to broker pop-os.localdomain:9092 (id: 0 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1326)
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:277)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.backoff$1(ControllerChannelManager.scala:238)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:266)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:44:58,845] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,847] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,850] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:44:58,864] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 15 and epoch zk version is now 15 (kafka.controller.KafkaController)
[2020-04-10 16:44:58,865] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:44:58,868] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:44:58,871] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:44:58,873] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:44:58,881] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 766) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,892] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,904] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:44:58,918] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,922] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,923] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:44:58,923] INFO [Controller id=0] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 16:44:58,923] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:44:58,929] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:44:58,929] INFO [Controller id=0] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 16:44:58,929] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:44:58,930] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 16:44:58,930] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:44:58,937] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:44:58,938] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:44:58,941] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:44:58,967] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:44:59,006] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:44:59,008] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:44:59,013] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:44:59,034] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(BatchTopic-0 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:44:59,034] INFO [Controller id=0] Ready to serve as the new controller with epoch 15 (kafka.controller.KafkaController)
[2020-04-10 16:44:59,038] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:44:59,039] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:44:59,039] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:44:59,039] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:44:59,040] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:44:59,048] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:45:00,378] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 16:45:00,379] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:45:00,381] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:45:00,383] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-04-10 16:45:00,385] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:45:00,405] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2020-04-10 16:45:00,408] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 766, 1 -> 786) (kafka.controller.KafkaController)
[2020-04-10 16:45:00,436] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:00,446] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:45:02,153] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:45:02,153] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:45:02,155] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 16:45:02,155] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:45:02,158] INFO [RequestSendThread controllerId=0] Controller 0 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:45:02,158] DEBUG [Controller id=0] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 16:45:02,160] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 766, 1 -> 786, 2 -> 804) (kafka.controller.KafkaController)
[2020-04-10 16:45:02,209] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:02,220] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:45:04,050] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:45:04,051] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:45:04,055] DEBUG [Controller id=0] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 16:45:04,059] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 16:45:04,061] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 16:45:04,063] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions BatchTopic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 16:45:04,075] INFO [Controller id=0] Partition BatchTopic-0 completed preferred replica leader election. New leader is 2 (kafka.controller.KafkaController)
[2020-04-10 16:45:10,321] DEBUG [Controller id=0] Sending MetadataRequest to Brokers: Vector(0, 1, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 16:45:32,298] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-10 16:45:33,011] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:45:33,011] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:45:33,012] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 16:45:33,104] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,0,LeaderEpoch:12,ControllerEpoch:15) (kafka.controller.KafkaController)
[2020-04-10 16:45:33,113] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 16:45:33,113] DEBUG [Controller id=0] All shutting down brokers: 0,2 (kafka.controller.KafkaController)
[2020-04-10 16:45:33,113] DEBUG [Controller id=0] Live brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:45:33,120] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:45:33,137] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:45:33,137] TRACE [Controller id=0] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:13,ControllerEpoch:15) (kafka.controller.KafkaController)
[2020-04-10 16:45:33,138] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,239] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,340] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,442] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,544] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,646] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,747] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,849] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:33,951] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:34,058] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:34,160] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:34,262] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker pop-os.localdomain:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to pop-os.localdomain:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:296)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:250)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-04-10 16:45:34,330] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:34,331] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:34,331] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:34,332] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:45:34,332] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 16:45:34,333] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:34,334] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:34,336] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:45:34,337] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:34,338] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:34,338] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:34,338] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:45:34,339] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(2, 1, 0) (kafka.controller.KafkaController)
[2020-04-10 16:45:34,341] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:34,342] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:34,343] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,344] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,344] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,344] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,346] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,346] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,346] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,347] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,348] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,348] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,350] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:45:34,367] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 16 and epoch zk version is now 16 (kafka.controller.KafkaController)
[2020-04-10 16:45:34,368] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:45:34,370] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:45:34,373] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:45:34,375] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:45:34,379] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 786) (kafka.controller.KafkaController)
[2020-04-10 16:45:34,385] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2020-04-10 16:45:34,392] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:45:34,397] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,397] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2020-04-10 16:45:34,397] INFO [Controller id=1] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:45:34,397] INFO [Controller id=1] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 16:45:34,397] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:45:34,402] INFO [Controller id=1] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:45:34,402] INFO [Controller id=1] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 16:45:34,403] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:45:34,403] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 16:45:34,405] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:45:34,412] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:34,412] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:45:34,416] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:34,428] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:34,440] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OfflineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:34,440] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:34,443] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:34,444] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:34,445] INFO [Controller id=1] Ready to serve as the new controller with epoch 16 (kafka.controller.KafkaController)
[2020-04-10 16:45:34,448] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:45:34,448] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:45:34,449] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:45:34,449] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:45:34,450] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:45:34,460] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:45:38,633] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:45:38,633] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:45:38,633] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:45:38,650] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:1,ISR:1,LeaderEpoch:13,ControllerEpoch:16) (kafka.controller.KafkaController)
[2020-04-10 16:45:39,258] INFO [Controller id=1] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-04-10 16:45:39,259] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:45:39,269] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:45:39,280] INFO [Controller id=1] New broker startup callback for 0 (kafka.controller.KafkaController)
[2020-04-10 16:45:39,286] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:45:39,292] DEBUG [Controller id=1] Register BrokerModifications handler for Vector(0) (kafka.controller.KafkaController)
[2020-04-10 16:45:39,295] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 786, 0 -> 830) (kafka.controller.KafkaController)
[2020-04-10 16:45:39,369] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:39,382] DEBUG [Controller id=0] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:45:39,461] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:45:39,462] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:45:39,464] DEBUG [Controller id=1] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 16:45:39,465] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 16:45:39,467] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 16:45:39,467] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 16:45:43,025] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-04-10 16:45:43,026] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:45:43,029] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:45:43,029] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-04-10 16:45:43,032] INFO [RequestSendThread controllerId=1] Controller 1 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:45:43,033] DEBUG [Controller id=1] Register BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2020-04-10 16:45:43,035] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 786, 0 -> 830, 2 -> 862) (kafka.controller.KafkaController)
[2020-04-10 16:45:43,095] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:43,128] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-04-10 16:45:43,664] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2020-04-10 16:45:43,664] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2020-04-10 16:45:43,664] DEBUG [Controller id=1] Live brokers: 0,2 (kafka.controller.KafkaController)
[2020-04-10 16:45:43,683] TRACE [Controller id=1] All leaders = BatchTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:16) (kafka.controller.KafkaController)
[2020-04-10 16:45:44,792] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:44,793] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:44,793] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:45:44,794] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:45:44,795] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(2, 1, 0) (kafka.controller.KafkaController)
[2020-04-10 16:45:44,797] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:44,799] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:44,801] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,801] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,801] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,805] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,806] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,806] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,809] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,809] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,809] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,813] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:45:44,842] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 17 and epoch zk version is now 17 (kafka.controller.KafkaController)
[2020-04-10 16:45:44,843] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-04-10 16:45:44,848] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-10 16:45:44,851] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-10 16:45:44,854] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-04-10 16:45:44,851] DEBUG [Controller id=0] Broker 2 was elected as controller instead of broker 0 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2020-04-10 16:45:44,861] INFO [Controller id=2] Initialized broker epochs cache: Map(0 -> 830, 2 -> 862) (kafka.controller.KafkaController)
[2020-04-10 16:45:44,869] DEBUG [Controller id=2] Register BrokerModifications handler for Set(0, 2) (kafka.controller.KafkaController)
[2020-04-10 16:45:44,879] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:45:44,885] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-04-10 16:45:44,889] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,889] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,889] INFO [Controller id=2] Currently active brokers in the cluster: Set(0, 2) (kafka.controller.KafkaController)
[2020-04-10 16:45:44,890] INFO [Controller id=2] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-10 16:45:44,892] INFO [Controller id=2] Current list of topics in the cluster: Set(BatchTopic) (kafka.controller.KafkaController)
[2020-04-10 16:45:44,893] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-10 16:45:44,901] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-10 16:45:44,901] INFO [Controller id=2] List of topics ineligible for deletion: BatchTopic (kafka.controller.KafkaController)
[2020-04-10 16:45:44,901] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-10 16:45:44,902] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set(BatchTopic) (kafka.controller.TopicDeletionManager)
[2020-04-10 16:45:44,902] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-10 16:45:44,912] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:44,912] INFO [RequestSendThread controllerId=2] Controller 2 connected to pop-os.localdomain:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,912] INFO [RequestSendThread controllerId=2] Controller 2 connected to pop-os.localdomain:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-10 16:45:44,917] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:44,938] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:44,953] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> Map([Topic=BatchTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=2] -> OnlineReplica, [Topic=BatchTopic,Partition=0,Replica=1] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:45:44,953] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:44,956] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:44,958] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> Map(BatchTopic-0 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:45:44,959] INFO [Controller id=2] Ready to serve as the new controller with epoch 17 (kafka.controller.KafkaController)
[2020-04-10 16:45:44,963] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:45:44,963] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-10 16:45:44,963] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-10 16:45:44,964] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-10 16:45:44,965] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-04-10 16:45:44,974] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-10 16:45:49,178] DEBUG [Controller id=2] Sending MetadataRequest to Brokers: Vector(0, 2) for TopicPartitions: ArrayBuffer(BatchTopic-0) (kafka.controller.KafkaController)
[2020-04-10 16:45:49,975] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-04-10 16:45:49,975] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-10 16:45:49,977] DEBUG [Controller id=2] Preferred replicas by broker Map(2 -> Map(BatchTopic-0 -> Vector(2, 1, 0))) (kafka.controller.KafkaController)
[2020-04-10 16:45:49,978] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 Map(BatchTopic-0 -> Vector(2, 1, 0)) (kafka.controller.KafkaController)
[2020-04-10 16:45:49,979] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-04-10 16:45:49,980] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions BatchTopic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-04-10 16:45:50,021] INFO [Controller id=2] Partition BatchTopic-0 completed preferred replica leader election. New leader is 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:28,245] INFO [Controller id=2] Shutting down broker 0 (kafka.controller.KafkaController)
[2020-04-10 16:48:28,246] DEBUG [Controller id=2] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2020-04-10 16:48:28,246] DEBUG [Controller id=2] Live brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:28,250] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:48:28,264] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=BatchTopic,Partition=0,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-04-10 16:48:28,265] TRACE [Controller id=2] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:16,ControllerEpoch:17) (kafka.controller.KafkaController)
[2020-04-10 16:48:28,269] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:28,269] DEBUG [Controller id=2] All shutting down brokers: 0,2 (kafka.controller.KafkaController)
[2020-04-10 16:48:28,269] DEBUG [Controller id=2] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:48:28,283] TRACE [Controller id=2] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:16,ControllerEpoch:17) (kafka.controller.KafkaController)
[2020-04-10 16:48:29,706] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:48:29,706] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:48:29,707] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:48:29,707] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:48:29,707] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-04-10 16:48:29,708] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:48:29,709] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:48:29,710] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-04-10 16:48:29,717] INFO [Controller id=2] Newly added brokers: , deleted brokers: 0, bounced brokers: , all live brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:29,718] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:48:29,718] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:48:29,719] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:48:29,721] INFO [Controller id=2] Broker failure callback for 0 (kafka.controller.KafkaController)
[2020-04-10 16:48:29,723] INFO [Controller id=2] Removed 0 from list of shutting down brokers. (kafka.controller.KafkaController)
[2020-04-10 16:48:29,744] DEBUG [Controller id=2] Unregister BrokerModifications handler for Vector(0) (kafka.controller.KafkaController)
[2020-04-10 16:48:29,745] INFO [Controller id=2] Updated broker epochs cache: Map(2 -> 862) (kafka.controller.KafkaController)
[2020-04-10 16:48:33,296] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:33,296] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:33,296] DEBUG [Controller id=2] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:48:33,301] TRACE [Controller id=2] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:16,ControllerEpoch:17) (kafka.controller.KafkaController)
[2020-04-10 16:48:38,310] INFO [Controller id=2] Shutting down broker 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:38,310] DEBUG [Controller id=2] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2020-04-10 16:48:38,310] DEBUG [Controller id=2] Live brokers:  (kafka.controller.KafkaController)
[2020-04-10 16:48:38,315] TRACE [Controller id=2] All leaders = BatchTopic-0 -> (Leader:2,ISR:2,LeaderEpoch:16,ControllerEpoch:17) (kafka.controller.KafkaController)
[2020-04-10 16:48:44,280] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:48:44,281] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:48:44,281] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-10 16:48:44,281] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-04-10 16:48:44,281] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(2) (kafka.controller.KafkaController)
[2020-04-10 16:48:44,282] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-04-10 16:48:44,283] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-04-10 16:48:44,283] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-04-10 16:48:44,284] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-04-10 16:48:44,284] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-04-10 16:48:44,286] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
